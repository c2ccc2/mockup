/*! 
 Build based on gin-vue-admin 
 Time : 1691228829000 */
import{x as e,a4 as l,b1 as a,F as t,y as s,aB as o,aK as r,B as i,A as n,o as u,c as p,b as d,J as c,K as m,h as v,d as f,_ as g,aP as b,ah as y,a8 as h,a2 as k,D as w,n as _,G as j,g as C,t as x,e as S,aH as I,I as V,a7 as A,r as D,l as E,T as N,w as z,j as U,E as F,ao as T,b2 as R,a as B,V as W,W as $,$ as q,k as O}from"./index-705282a4.js";import{E as M}from"./dialog-d78ef494.js";import"./overlay-7a08aeb2.js";import{a as P,E as H}from"./form-item-26e276c5.js";/* empty css              */import{E as K}from"./pagination-7f7cceec.js";import"./tag-03de541d.js";import"./select-f422150a.js";import"./scrollbar-b8aea7aa.js";/* empty css               */import{E as G,a as J}from"./table-column-7bd38e67.js";import"./checkbox-59197a78.js";/* empty css                */import{E as X}from"./popover-73685ece.js";import{E as Y}from"./card-a4681bf9.js";/* empty css               */import{E as Z}from"./switch-d08f9663.js";import{f as L,u as Q}from"./pdMock-8c8d5a10.js";import{g as ee,d as le,f as ae,a as te,c as se,u as oe}from"./pdRelease-8c4ef351.js";import{g as re}from"./image-81157f0c.js";/* empty css               *//* empty css                 */import{E as ie}from"./index-aa813834.js";import{f as ne}from"./format-090e5c0e.js";import"./_baseClone-39b1660f.js";import"./_Uint8Array-24a3c252.js";import"./_initCloneObject-acf8bf06.js";import"./isEqual-221d581a.js";import"./index-586999c8.js";import"./index-c7c2266c.js";import"./strings-5cc13f5a.js";import"./dropdown-d2c71e78.js";import"./index-14811586.js";import"./cloneDeep-4f27332c.js";import"./date-225eaf4f.js";import"./dictionary-96530e9f.js";import"./sysDictionary-67004c76.js";const ue=Symbol("elDescriptions");var pe=e({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String},type:{type:String}},setup:()=>({descriptions:l(ue,{})}),render(){var e,l,i,n,u,p;const d=a(this.cell),{border:c,direction:m}=this.descriptions,v="vertical"===m,f=(null==(i=null==(l=null==(e=this.cell)?void 0:e.children)?void 0:l.label)?void 0:i.call(l))||d.label,g=null==(p=null==(u=null==(n=this.cell)?void 0:n.children)?void 0:u.default)?void 0:p.call(u),b=d.span,y=d.align?"is-".concat(d.align):"",h=d.labelAlign?"is-".concat(d.labelAlign):y,k=d.className,w=d.labelClassName,_={width:t(d.width),minWidth:t(d.minWidth)},j=s("descriptions");switch(this.type){case"label":return o(this.tag,{style:_,class:[j.e("cell"),j.e("label"),j.is("bordered-label",c),j.is("vertical-label",v),h,w],colSpan:v?b:1},f);case"content":return o(this.tag,{style:_,class:[j.e("cell"),j.e("content"),j.is("bordered-content",c),j.is("vertical-content",v),y,k],colSpan:v?b:2*b-1},g);default:return o("td",{style:_,class:[j.e("cell"),y],colSpan:b},[r(f)?void 0:o("span",{class:[j.e("label"),w]},f),o("span",{class:[j.e("content"),k]},g)])}}});const de=i({row:{type:Array,default:()=>[]}}),ce={key:1},me=e({name:"ElDescriptionsRow"});var ve=g(e({...me,props:de,setup(e){const a=l(ue,{});return(e,l)=>"vertical"===n(a).direction?(u(),p(c,{key:0},[d("tr",null,[(u(!0),p(c,null,m(e.row,((e,l)=>(u(),v(n(pe),{key:"tr1-".concat(l),cell:e,tag:"th",type:"label"},null,8,["cell"])))),128))]),d("tr",null,[(u(!0),p(c,null,m(e.row,((e,l)=>(u(),v(n(pe),{key:"tr2-".concat(l),cell:e,tag:"td",type:"content"},null,8,["cell"])))),128))])],64)):(u(),p("tr",ce,[(u(!0),p(c,null,m(e.row,((e,l)=>(u(),p(c,{key:"tr3-".concat(l)},[n(a).border?(u(),p(c,{key:0},[f(n(pe),{cell:e,tag:"td",type:"label"},null,8,["cell"]),f(n(pe),{cell:e,tag:"td",type:"content"},null,8,["cell"])],64)):(u(),v(n(pe),{key:1,cell:e,tag:"td",type:"both"},null,8,["cell"]))],64)))),128))]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/descriptions-row.vue"]]);const fe=i({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:b,title:{type:String,default:""},extra:{type:String,default:""}}),ge=e({name:"ElDescriptions"});var be=g(e({...ge,props:fe,setup(e){const l=e,a=s("descriptions"),t=y(),o=h();k(ue,l);const r=w((()=>[a.b(),a.m(t.value)])),i=(e,l,a,t=!1)=>(e.props||(e.props={}),l>a&&(e.props.span=a),t&&(e.props.span=l),e),f=()=>{var e;const a=I(null==(e=o.default)?void 0:e.call(o)).filter((e=>{var l;return"ElDescriptionsItem"===(null==(l=null==e?void 0:e.type)?void 0:l.name)})),t=[];let s=[],r=l.column,n=0;return a.forEach(((e,o)=>{var u;const p=(null==(u=e.props)?void 0:u.span)||1;if(o<a.length-1&&(n+=p>r?r:p),o===a.length-1){const a=l.column-n%l.column;return s.push(i(e,a,r,!0)),void t.push(s)}p<r?(r-=p,s.push(e)):(s.push(i(e,p,r)),t.push(s),r=l.column,s=[])})),t};return(e,l)=>(u(),p("div",{class:_(n(r))},[e.title||e.extra||e.$slots.title||e.$slots.extra?(u(),p("div",{key:0,class:_(n(a).e("header"))},[d("div",{class:_(n(a).e("title"))},[j(e.$slots,"title",{},(()=>[C(x(e.title),1)]))],2),d("div",{class:_(n(a).e("extra"))},[j(e.$slots,"extra",{},(()=>[C(x(e.extra),1)]))],2)],2)):S("v-if",!0),d("div",{class:_(n(a).e("body"))},[d("table",{class:_([n(a).e("table"),n(a).is("bordered",e.border)])},[d("tbody",null,[(u(!0),p(c,null,m(f(),((e,l)=>(u(),v(ve,{key:l,row:e},null,8,["row"])))),128))])],2)],2)],2))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/description.vue"]]),ye=e({name:"ElDescriptionsItem",props:{label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}});const he=V(be,{DescriptionsItem:ye}),ke=A(ye),we={name:"UploadCommon",methods:{}},_e=Object.assign(we,{props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,t=D(""),s=E(),o=D(!1),r=D(a.modelValue);N(r.value,(e=>{console.log(e),l("update:modelValue",e)}));const i=e=>{const{data:l}=e;l.file&&(r.value.push({name:l.file.name,url:l.file.url}),o.value=!1)},d=()=>{U({type:"error",message:"上传失败"}),o.value=!1};return(e,l)=>{const a=F,o=ie;return u(),p("div",null,[f(o,{multiple:"",action:"".concat(t.value,"/fileUploadAndDownload/upload?noSave=1"),headers:{"x-token":n(s).token},"on-error":d,"on-success":i,"show-file-list":!0,"file-list":r.value,class:"upload-btn"},{default:z((()=>[f(a,{type:"primary"},{default:z((()=>[C("上传文件")])),_:1})])),_:1},8,["action","headers","file-list"])])}}}),je=d("br",null,null,-1),Ce={class:"gva-table-box"},xe={class:"gva-btn-list"},Se=d("p",null,"确定要删除吗？",-1),Ie={style:{"text-align":"right","margin-top":"8px"}},Ve={class:"gva-pagination"},Ae=d("text",null,"请上传原型生成的html文件包，只能上传zip格式。",-1),De=d("text",null,"请保证压缩包里有start.html文件。",-1),Ee={class:"dialog-footer"},Ne={name:"PdRelease"},ze=Object.assign(Ne,{setup(e){const l=T(),a=parseInt(l.params.id);R((e=>{"PdRelease"===e.name&&(s.mockupId=e.params.id)}));const t=D({}),s=D({mockupId:0,releaseNote:"",mockup_html:"",mockupName:""}),o=B({mockupId:[{required:!0,message:"",trigger:["input","blur"]}],mockupFile:[{required:!0,message:"",trigger:["input","blur"]}]}),r=async e=>{const l=await L({ID:e});0===l.code&&(t.value=l.data.repdMock)};r(a);const i=async()=>{t.shareStatus=!t.shareStatus,await Q(t.value),r(a)};B({createdAt:[{validator:(e,l,a)=>{y.value.startCreatedAt&&!y.value.endCreatedAt?a(new Error("请填写结束日期")):!y.value.startCreatedAt&&y.value.endCreatedAt?a(new Error("请填写开始日期")):y.value.startCreatedAt&&y.value.endCreatedAt&&(y.value.startCreatedAt.getTime()===y.value.endCreatedAt.getTime()||y.value.startCreatedAt.getTime()>y.value.endCreatedAt.getTime())?a(new Error("开始日期应当早于结束日期")):a()},trigger:"change"}]});const c=D();D();const m=D(1),v=D(0),g=D(10),b=D([]),y=D({mockupId:Number(l.params.id)}),h=e=>{g.value=e,w()},k=e=>{m.value=e,w()},w=async()=>{const e=await ee({page:m.value,pageSize:g.value,...y.value});0===e.code&&(b.value=e.data.list,v.value=e.data.total,m.value=e.data.page,g.value=e.data.pageSize)};w();(async()=>{})();const _=D([]),j=e=>{_.value=e},S=D(!1),I=async()=>{const e=[];if(0===_.value.length)return void U({type:"warning",message:"请选择要删除的数据"});_.value&&_.value.map((l=>{e.push(l.ID)}));0===(await le({ids:e})).code&&(U({type:"success",message:"删除成功"}),b.value.length===e.length&&m.value>1&&m.value--,S.value=!1,w())},V=D(""),A=async e=>{0===(await te({ID:e.ID})).code&&(U({type:"success",message:"删除成功"}),1===b.value.length&&m.value>1&&m.value--,w())},E=D(!1),N=()=>{V.value="create",E.value=!0},ie=()=>{E.value=!1,s.value={releaseNote:"",mockup_html:""}},ue=async()=>{var e;null==(e=c.value)||e.validate((async e=>{if(console.log("valid:",e),!e)return;let l;switch(V.value){case"create":s.value.mockupId=a,s.value.mockupFile=s.value.mockupFile[0].url,l=await se(s.value);break;case"update":s.value.mockupId=a,s.value.mockupFile=s.value.mockupFile[0].url,l=await oe(s.value);break;default:l=await se(s.value)}0===l.code&&(U({type:"success",message:"创建/更改成功"}),ie(),w())}))},pe=window.location.protocol+"//"+window.location.host;return(e,l)=>{const a=Z,r=ke,y=F,w=he,D=Y,U=X,T=G,R=J,B=K,L=O,Q=P,ee=H,le=M;return u(),p("div",null,[f(D,null,{default:z((()=>[f(w,{title:t.value.title,column:"2"},{default:z((()=>[f(r,{label:"分享状态"},{default:z((()=>[f(a,{modelValue:t.value.shareStatus,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value.shareStatus=e),"active-text":"已开启分享","inactive-text":"未开启分享",onChange:i},null,8,["modelValue"])])),_:1}),f(r,{label:""}),f(r,{label:"访问链接"},{default:z((()=>[C(x(pe+"/pd/"+t.value.shareUrl),1)])),_:1}),f(r,{label:""},{default:z((()=>[f(y,{type:"primary",link:"",icon:"link",class:"table-button",onClick:l[1]||(l[1]=e=>(async e=>{console.log("url:",e),window.open(e,"_blank")})(pe+"/front/#/pd/"+t.value.shareUrl))},{default:z((()=>[C("访问")])),_:1})])),_:1}),f(r,{label:"备注1"},{default:z((()=>[C("每次关闭再开启的分享地址都不一样")])),_:1}),f(r,{label:""}),f(r,{label:"备注2"},{default:z((()=>[C("分享功能需要部署用户端系统，否则无法访问")])),_:1}),f(r,{label:""}),f(r,{label:"备注3"},{default:z((()=>[C("关闭分享后，原型将无法访问")])),_:1}),f(r,{label:""})])),_:1},8,["title"])])),_:1}),je,d("div",Ce,[d("div",xe,[f(y,{type:"primary",icon:"plus",onClick:N},{default:z((()=>[C("新增")])),_:1}),f(U,{visible:S.value,"onUpdate:visible":l[4]||(l[4]=e=>S.value=e),placement:"top",width:"160"},{reference:z((()=>[f(y,{icon:"delete",style:{"margin-left":"10px"},disabled:!_.value.length,onClick:l[3]||(l[3]=e=>S.value=!0)},{default:z((()=>[C("删除")])),_:1},8,["disabled"])])),default:z((()=>[Se,d("div",Ie,[f(y,{type:"primary",link:"",onClick:l[2]||(l[2]=e=>S.value=!1)},{default:z((()=>[C("取消")])),_:1}),f(y,{type:"primary",onClick:I},{default:z((()=>[C("确定")])),_:1})])])),_:1},8,["visible"])]),f(R,{ref:"multipleTable",style:{width:"100%"},"tooltip-effect":"dark",data:b.value,"row-key":"ID",onSelectionChange:j},{default:z((()=>[f(T,{type:"selection",width:"30"}),f(T,{align:"left",label:"版本",prop:"ID",width:"60"}),f(T,{align:"left",label:"发布日期",width:"160"},{default:z((e=>[C(x(n(ne)(e.row.CreatedAt)),1)])),_:1}),f(T,{align:"left",label:"发布说明",prop:"releaseNote"}),f(T,{align:"left",label:"访问链接",prop:"mockup_html",width:"120"},{default:z((e=>[f(y,{type:"primary",link:"",icon:"link",class:"table-button",onClick:l=>(async e=>{console.log("url:",e),e+="start.html",window.open(re(e),"_blank")})(e.row.mockup_html)},{default:z((()=>[C("访问")])),_:2},1032,["onClick"])])),_:1}),f(T,{align:"left",label:"操作"},{default:z((e=>[f(y,{type:"primary",link:"",icon:"edit",class:"table-button",onClick:l=>(async e=>{const l=await ae({ID:e.ID});V.value="update",console.log("res:",l),0===l.code&&(delete l.data.repdRelease.mockupFile,s.value=l.data.repdRelease,E.value=!0)})(e.row)},{default:z((()=>[C("编辑")])),_:2},1032,["onClick"]),f(y,{type:"primary",link:"",icon:"delete",onClick:l=>{return a=e.row,void q.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{A(a)}));var a}},{default:z((()=>[C("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),d("div",Ve,[f(B,{layout:"total, sizes, prev, pager, next, jumper","current-page":m.value,"page-size":g.value,"page-sizes":[10,30,50,100],total:v.value,onCurrentChange:k,onSizeChange:h},null,8,["current-page","page-size","total"])])]),f(le,{modelValue:E.value,"onUpdate:modelValue":l[8]||(l[8]=e=>E.value=e),"before-close":ie,title:"create"===V.value?"添加发布":"修改发布","destroy-on-close":""},{footer:z((()=>[d("div",Ee,[f(y,{onClick:ie},{default:z((()=>[C("取 消")])),_:1}),f(y,{type:"primary",onClick:ue},{default:z((()=>[C("确 定")])),_:1})])])),default:z((()=>[f(ee,{model:s.value,"label-position":"right",ref_key:"elFormRef",ref:c,rules:o,"label-width":"80px"},{default:z((()=>[W(f(Q,{label:"产品ID:",prop:"mockupId",display:"disable"},{default:z((()=>[f(L,{modelValue:s.value.mockupId,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value.mockupId=e),modelModifiers:{number:!0},clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1},512),[[$,!1]]),f(Q,{label:"发布说明:",prop:"releaseNote"},{default:z((()=>[f(L,{type:"textarea",rows:"5",modelValue:s.value.releaseNote,"onUpdate:modelValue":l[6]||(l[6]=e=>s.value.releaseNote=e),clearable:!0,placeholder:"请输入"},null,8,["modelValue"])])),_:1}),f(Q,{label:"文件:",prop:"mockupFile"},{default:z((()=>[f(_e,{modelValue:s.value.mockupFile,"onUpdate:modelValue":l[7]||(l[7]=e=>s.value.mockupFile=e)},null,8,["modelValue"])])),_:1}),f(Q,{label:"说明："},{default:z((()=>[Ae,De])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}});export{ze as default};
