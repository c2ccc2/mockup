import{D as C,_ as ze,F as Le,u as Te,e as Qe,r as u,J as ue,L as Ee,a2 as Ae,am as Ge,f,M as se,c as Ke,o as w,N as g,h as e,a1 as F,i as a,n as pe,m as n,p as r,k as I,j as h,y as Oe,z as He}from"./index-CR6ovanu.js";import{d as Je,G as ce,a as We}from"./projectuser-BUOWjOEZ.js";function Xe(s){return C({url:"/projectManager/projectBase/MyCreateProject",method:"post",data:s})}function Ye(s){return C({url:"/projectManager/projectBase/Get/"+s,method:"get"})}function Ze(s){return C({url:"/projectManager/projectBase/Add",method:"post",data:s})}function et(s){return C({url:"/projectManager/projectBase/Edit",method:"put",data:s})}function tt(s){return C({url:"/projectManager/projectBase/Remove/"+s,method:"delete"})}function at(s){return C({url:"/projectManager/filehistory/GetCustomPagedListAsync",method:"post",data:s})}const me=s=>(Oe("data-v-b4d5f498"),s=s(),He(),s),lt={class:"app-container"},ot={slot:"footer",class:"dialog-footer"},nt={class:"app-container"},rt={class:"app-container"},it={class:"app-container"},dt=me(()=>h("div",{class:"el-upload__text"},[r("将文件拖到此处，或"),h("em",null,"点击上传")],-1)),ut=me(()=>h("div",{class:"el-upload__tip text-center"},[h("div",{class:"el-upload__tip"}),h("span",null,"仅允许导入zip格式文件。")],-1)),st={class:"dialog-footer"},pt=Le({name:"ProjectBase"}),ct=Object.assign(pt,{setup(s){Te();const{proxy:d}=Qe(),T=u(!1),J=u(!1),Q=u(!1),{project_states:mt}=d.useDict("project_states"),W=u([]),x=u(!1),v=u(!0),E=u(!0),A=u([]),X=u(!0),Y=u(!0),k=u(0),Z=u(0),ee=u(0),G=u(""),te=u([]),ae=u([]),le=u([]),m=ue({open:!1,title:"上传原型文件,zip格式",isUploading:!1,data:{UploadDescription:"",ProjectId:""},headers:{Authorization:"Bearer "+Ee()},url:"/prod-api/projectManager/projectfile/Add"}),fe=ue({form:{projectId:0,projectName:"",projectDescription:"",projectState:10,createBy:"",createTime:"",updateBy:"",updateTime:""},queryParams:{pageModel:{PageIndex:1,PageSize:10},projectName:null},userqueryParams:{pageModel:{PageIndex:1,PageSize:10},projectId:0,selectType:"join",userName:""},unjoinuserqueryParams:{pageModel:{PageIndex:1,PageSize:10},projectId:0,selectType:"unjoin",userName:""},filequeryParams:{pageModel:{PageIndex:1,PageSize:10},projectId:0,UploadDescription:""},rules:{projectName:[{required:!0,message:"项目名称不能为空",trigger:"blur"}]}}),{queryParams:P,userqueryParams:_,unjoinuserqueryParams:j,filequeryParams:U,form:y,rules:ge}=Ae(fe);function V(){v.value=!0,Xe(P.value).then(o=>{W.value=o.rows,k.value=o.total,v.value=!1})}function oe(){v.value=!0,ce(_.value).then(o=>{te.value=o.rows,Z.value=o.total,v.value=!1})}function ne(){v.value=!0,ce(j.value).then(o=>{ae.value=o.rows,ee.value=o.total,v.value=!1})}function M(){v.value=!0,at(U.value).then(o=>{le.value=o.rows,k.value=o.total,v.value=!1})}const ve=(o,t,c)=>{m.isUploading=!0},_e=(o,t,c)=>{m.open=!1,m.isUploading=!1,d.$refs.uploadRef.handleRemove(t),d.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+o.msg+"</div>","上传结果",{dangerouslyUseHTMLString:!0}),M()};function je(){Q.value=!0,B()}function ye(){x.value=!1,K()}function K(){y.value={projectId:0,projectName:"",projectDescription:"",projectState:10,createBy:"",createTime:"",updateBy:"",updateTime:""},d.resetForm("projectBaseRef")}async function O(){P.value.pageModel.PageIndex=1,V()}async function S(){oe()}async function B(){j.value.pageModel.PageIndex=1,j.value.selectType="unjoin",ne()}function he(){d.resetForm("queryUserRef"),S()}function be(){d.resetForm("queryunjoinUserRef"),B()}function we(){d.resetForm("queryFileRef"),M()}function Pe(){d.resetForm("queryRef"),O()}function Ue(o){A.value=o.map(t=>t.projectId),X.value=o.length!==1,Y.value=!o.length}function Ie(){K(),x.value=!0,G.value="添加项目"}function re(o){K();const t=o.projectId||A.value;Ye(t).then(c=>{y.value=c.data,x.value=!0,G.value="修改项目"})}function ke(){d.$refs.projectBaseRef.validate(o=>{o&&(y.value.projectId!=null&&y.value.projectId>0?et(y.value).then(t=>{d.$modal.msgSuccess("修改成功"),x.value=!1,V()}):Ze(y.value).then(t=>{d.$modal.msgSuccess("新增成功"),x.value=!1,V()}))})}function ie(o){const t=o.projectId||A.value;d.$modal.confirm('是否确认删除编号为"'+t+'"的数据项？').then(function(){return tt(t)}).then(()=>{V(),d.$modal.msgSuccess("删除成功")}).catch(()=>{})}function xe(o){_.value.projectId=o.projectId,j.value.projectId=o.projectId,T.value=!0,S()}function de(){U.value.pageModel.PageIndex=1,M()}function Ve(o){const t={projectId:_.value.projectId,userId:o.userId};We(t).then(()=>{d.$modal.msgSuccess("添加成功"),S(),B()}).catch(c=>{d.$modal.msgError("添加失败："+c.message)})}function Ce(o){d.$modal.confirm("是否确认把用户从项目移除？").then(function(){const t={projectId:_.value.projectId,userIds:[o.userId]};Je(t).then(()=>{d.$modal.msgSuccess("移除成功"),S(),B()}).catch(c=>{d.$modal.msgError("移除失败："+c.message)})}).catch(()=>{})}function Me(){d.$refs.uploadRef.submit(),M()}function Se(){m.open=!0}function Be(o){window.open("/prod-api/"+o.filePath,"_blank")}const Ne=()=>{console.log("执行清理操作")};return Ge(()=>{Ne(),console.log("组件实例已销毁")}),V(),(o,t)=>{const c=f("el-input"),b=f("el-form-item"),i=f("el-button"),N=f("el-form"),H=f("el-col"),Re=f("right-toolbar"),De=f("el-row"),p=f("el-table-column"),q=f("el-table"),z=f("pagination"),R=f("el-dialog"),$e=f("upload-filled"),Fe=f("el-icon"),qe=f("el-upload"),D=se("hasPermi"),L=se("loading");return w(),Ke("div",lt,[g(e(N,{model:n(P),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[e(b,{label:"项目名称",prop:"projectName"},{default:a(()=>[e(c,{modelValue:n(P).projectName,"onUpdate:modelValue":t[0]||(t[0]=l=>n(P).projectName=l),placeholder:"请输入项目名称",clearable:"",onKeyup:pe(O,["enter"])},null,8,["modelValue"])]),_:1}),e(b,null,{default:a(()=>[e(i,{type:"primary",icon:"Search",onClick:O},{default:a(()=>[r("搜索")]),_:1}),e(i,{icon:"Refresh",onClick:Pe},{default:a(()=>[r("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[F,E.value]]),e(De,{gutter:10,class:"mb8"},{default:a(()=>[e(H,{span:1.5},{default:a(()=>[g((w(),I(i,{type:"primary",plain:"",icon:"Plus",onClick:Ie},{default:a(()=>[r("新增")]),_:1})),[[D,["projectManager:projectBase:add"]]])]),_:1}),e(H,{span:1.5},{default:a(()=>[g((w(),I(i,{type:"success",plain:"",icon:"Edit",disabled:X.value,onClick:re},{default:a(()=>[r("修改")]),_:1},8,["disabled"])),[[D,["projectManager:projectBase:edit"]]])]),_:1}),e(H,{span:1.5},{default:a(()=>[g((w(),I(i,{type:"danger",plain:"",icon:"Delete",disabled:Y.value,onClick:ie},{default:a(()=>[r("删除")]),_:1},8,["disabled"])),[[D,["projectManager:projectBase:remove"]]])]),_:1}),e(Re,{showSearch:E.value,"onUpdate:showSearch":t[1]||(t[1]=l=>E.value=l),onQueryTable:V},null,8,["showSearch"])]),_:1}),g((w(),I(q,{data:W.value,onSelectionChange:Ue},{default:a(()=>[e(p,{type:"selection",width:"55",align:"center"}),e(p,{label:"项目ID",align:"center",prop:"projectId",width:"110"}),e(p,{label:"项目名称",prop:"projectName"}),e(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[e(i,{link:"",type:"primary",icon:"User",onClick:$=>xe(l.row)},{default:a(()=>[r("项目用户")]),_:2},1032,["onClick"]),g((w(),I(i,{link:"",type:"primary",icon:"Edit",onClick:$=>re(l.row)},{default:a(()=>[r("修改")]),_:2},1032,["onClick"])),[[D,["projectManager:projectBase:edit"]]]),g((w(),I(i,{link:"",type:"primary",icon:"Delete",onClick:$=>ie(l.row)},{default:a(()=>[r("删除")]),_:2},1032,["onClick"])),[[D,["projectManager:projectBase:remove"]]])]),_:1})]),_:1},8,["data"])),[[L,v.value]]),g(e(z,{total:k.value,page:n(P).pageModel.PageIndex,"onUpdate:page":t[2]||(t[2]=l=>n(P).pageModel.PageIndex=l),limit:n(P).pageModel.PageSize,"onUpdate:limit":t[3]||(t[3]=l=>n(P).pageModel.PageSize=l),onPagination:V},null,8,["total","page","limit"]),[[F,k.value>0]]),e(R,{title:G.value,modelValue:x.value,"onUpdate:modelValue":t[6]||(t[6]=l=>x.value=l),width:"500px","append-to-body":""},{default:a(()=>[e(N,{ref:"projectBaseRef",model:n(y),rules:n(ge),"label-width":"80px"},{default:a(()=>[e(b,{label:"项目名称",prop:"projectName"},{default:a(()=>[e(c,{modelValue:n(y).projectName,"onUpdate:modelValue":t[4]||(t[4]=l=>n(y).projectName=l),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1}),e(b,{label:"项目描述",prop:"projectDescription"},{default:a(()=>[e(c,{modelValue:n(y).projectDescription,"onUpdate:modelValue":t[5]||(t[5]=l=>n(y).projectDescription=l),placeholder:"请输入项目描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),h("div",ot,[e(i,{type:"primary",onClick:ke},{default:a(()=>[r("确 定")]),_:1}),e(i,{onClick:ye},{default:a(()=>[r("取 消")]),_:1})])]),_:1},8,["title","modelValue"]),e(R,{modelValue:T.value,"onUpdate:modelValue":t[10]||(t[10]=l=>T.value=l),title:"已加入项目用户",width:"800px","append-to-body":""},{default:a(()=>[h("div",nt,[e(N,{model:n(_),ref:"queryUserRef",inline:!0},{default:a(()=>[e(b,{label:"用户名称",prop:"userName"},{default:a(()=>[e(c,{modelValue:n(_).userName,"onUpdate:modelValue":t[7]||(t[7]=l=>n(_).userName=l),placeholder:"请输入用户名称",clearable:"",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(b,null,{default:a(()=>[e(i,{type:"primary",icon:"Search",onClick:S},{default:a(()=>[r("搜索")]),_:1}),e(i,{icon:"Refresh",onClick:he},{default:a(()=>[r("重置")]),_:1}),e(i,{icon:"Plus",onClick:je},{default:a(()=>[r("添加用户")]),_:1})]),_:1})]),_:1},8,["model"]),g((w(),I(q,{data:te.value},{default:a(()=>[e(p,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(p,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(p,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[e(i,{link:"",type:"primary",icon:"Remove",onClick:$=>Ce(l.row)},{default:a(()=>[r("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,v.value]]),g(e(z,{total:k.value,page:n(_).pageModel.PageIndex,"onUpdate:page":t[8]||(t[8]=l=>n(_).pageModel.PageIndex=l),limit:n(_).pageModel.pageSize,"onUpdate:limit":t[9]||(t[9]=l=>n(_).pageModel.pageSize=l),onPagination:oe},null,8,["total","page","limit"]),[[F,Z.value>0]])])]),_:1},8,["modelValue"]),e(R,{modelValue:Q.value,"onUpdate:modelValue":t[14]||(t[14]=l=>Q.value=l),title:"待加入项目用户",width:"800px","append-to-body":""},{default:a(()=>[h("div",rt,[e(N,{model:n(j),ref:"queryunjoinUserRef",inline:!0},{default:a(()=>[e(b,{label:"用户名称",prop:"userName"},{default:a(()=>[e(c,{modelValue:n(j).userName,"onUpdate:modelValue":t[11]||(t[11]=l=>n(j).userName=l),placeholder:"请输入用户名称",clearable:"",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(b,null,{default:a(()=>[e(i,{type:"primary",icon:"Search",onClick:B},{default:a(()=>[r("搜索")]),_:1}),e(i,{icon:"Refresh",onClick:be},{default:a(()=>[r("重置")]),_:1})]),_:1})]),_:1},8,["model"]),g((w(),I(q,{data:ae.value},{default:a(()=>[e(p,{label:"用户名称",prop:"userName","show-overflow-tooltip":!0}),e(p,{label:"用户昵称",prop:"nickName","show-overflow-tooltip":!0}),e(p,{label:"手机",prop:"phonenumber","show-overflow-tooltip":!0}),e(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[e(i,{link:"",type:"primary",icon:"Plus",onClick:$=>Ve(l.row)},{default:a(()=>[r("加入")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,v.value]]),g(e(z,{total:k.value,page:n(j).pageModel.PageIndex,"onUpdate:page":t[12]||(t[12]=l=>n(j).pageModel.PageIndex=l),limit:n(j).pageModel.pageSize,"onUpdate:limit":t[13]||(t[13]=l=>n(j).pageModel.pageSize=l),onPagination:ne},null,8,["total","page","limit"]),[[F,ee.value>0]])])]),_:1},8,["modelValue"]),e(R,{modelValue:J.value,"onUpdate:modelValue":t[18]||(t[18]=l=>J.value=l),title:"项目原型管理",width:"800px","append-to-body":""},{default:a(()=>[h("div",it,[e(N,{model:n(U),ref:"queryFileRef",inline:!0},{default:a(()=>[e(b,{label:"描述",prop:"UploadDescription"},{default:a(()=>[e(c,{modelValue:n(U).UploadDescription,"onUpdate:modelValue":t[15]||(t[15]=l=>n(U).UploadDescription=l),placeholder:"请输入关键字",clearable:"",style:{width:"240px"},onKeyup:pe(de,["enter"])},null,8,["modelValue"])]),_:1}),e(b,null,{default:a(()=>[e(i,{type:"primary",icon:"Search",onClick:de},{default:a(()=>[r("搜索")]),_:1}),e(i,{icon:"Refresh",onClick:we},{default:a(()=>[r("重置")]),_:1}),e(i,{icon:"primary",onClick:Se},{default:a(()=>[r("添加")]),_:1})]),_:1})]),_:1},8,["model"]),g((w(),I(q,{data:le.value},{default:a(()=>[e(p,{type:"selection",width:"55",align:"center"}),r(" --> "),e(p,{label:"创建日期",prop:"createTime","show-overflow-tooltip":!0}),e(p,{label:"描述",prop:"uploadDescription","show-overflow-tooltip":!0}),e(p,{label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(l=>[e(i,{link:"",type:"primary",icon:"CircleClose",onClick:$=>Be(l.row)},{default:a(()=>[r("下载")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,v.value]]),g(e(z,{total:k.value,page:n(U).pageModel.PageIndex,"onUpdate:page":t[16]||(t[16]=l=>n(U).pageModel.PageIndex=l),limit:n(U).pageModel.PageSize,"onUpdate:limit":t[17]||(t[17]=l=>n(U).pageModel.PageSize=l),onPagination:M},null,8,["total","page","limit"]),[[F,k.value>0]])])]),_:1},8,["modelValue"]),e(R,{title:m.title,modelValue:m.open,"onUpdate:modelValue":t[21]||(t[21]=l=>m.open=l),width:"400px","append-to-body":""},{footer:a(()=>[h("div",st,[e(i,{type:"primary",onClick:Me},{default:a(()=>[r("确 定")]),_:1}),e(i,{onClick:t[20]||(t[20]=l=>m.open=!1)},{default:a(()=>[r("取 消")]),_:1})])]),default:a(()=>[e(qe,{ref:"uploadRef",limit:1,accept:"zip,rar",data:m.data,headers:m.headers,action:m.url,disabled:m.isUploading,"on-progress":ve,"on-success":_e,"auto-upload":!1,drag:""},{tip:a(()=>[ut]),default:a(()=>[e(Fe,{class:"el-icon--upload"},{default:a(()=>[e($e)]),_:1}),dt]),_:1},8,["data","headers","action","disabled"]),h("div",null,[e(c,{modelValue:m.data.UploadDescription,"onUpdate:modelValue":t[19]||(t[19]=l=>m.data.UploadDescription=l),type:"textarea",placeholder:"请输入描述"},null,8,["modelValue"])])]),_:1},8,["title","modelValue"])])}}}),vt=ze(ct,[["__scopeId","data-v-b4d5f498"]]);export{vt as default};
