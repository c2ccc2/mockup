/*! 
 Build based on gin-vue-admin 
 Time : 1691228829000 */
class t{constructor(t,e,i=1920){this.file=t,this.fileSize=e,this.maxWH=i}compress(){const t=this.file.type,e=this.file.size/1024;return new Promise((i=>{const h=new FileReader;h.readAsDataURL(this.file),h.onload=()=>{const s=document.createElement("canvas"),n=document.createElement("img");n.src=h.result,n.onload=()=>{const h=s.getContext("2d"),o=this.dWH(n.width,n.height,this.maxWH);s.width=o.width,s.height=o.height,h.clearRect(0,0,s.width,s.height),h.drawImage(n,0,0,s.width,s.height);const a=s.toDataURL(t,.9),l=this.fileSizeKB(a);l>this.fileSize&&console.log("图片尺寸太大!"+e+" >> "+l);const r=this.dataURLtoBlob(a,t),d=new File([r],this.file.name);i(d)}}}))}dWH(t,e,i){const h={width:t,height:e};return Math.max(t,e)>i?t>e?(h.width=i,h.height=Math.round(e*(i/t)),h):(h.height=i,h.width=Math.round(t*(i/e)),h):h}fileSizeKB(t){let e=0;return e=Math.round(3*t.split(",")[1].length/4/1024),e}dataURLtoBlob(t,e){const i=atob(t.split(",")[1]);let h=t.split(",")[0].split(":")[1].split(";")[0];const s=new ArrayBuffer(i.length),n=new Uint8Array(s);for(let o=0;o<i.length;o++)n[o]=i.charCodeAt(o);return e&&(h=e),new Blob([s],{type:h,lastModifiedDate:new Date})}}const e=t=>t&&"http"!==t.slice(0,4)?"/"+t:t;export{t as I,e as g};
